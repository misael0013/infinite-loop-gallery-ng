<section class="album-detail" *ngIf="album as a; else notFound">
  <header class="album-header">
    <a routerLink="/galeria" class="back">← Galería</a>
    <h1 class="album-title">{{ a.title }}</h1>
  </header>

  <!-- Grid compacto tipo mosaico -->
  <div class="images-grid">
    <figure class="shot" *ngFor="let src of images; let i = index">
      <button class="media" type="button" (click)="openLightbox(i)">
        <img [src]="src" [alt]="a.title || 'Foto'" loading="lazy" decoding="async" />
      </button>
      <figcaption class="caption">{{ getFilename(src) }}</figcaption>
    </figure>
  </div>
</section>

<ng-template #notFound>
  <div class="empty">Álbum no encontrado.</div>
</ng-template>

<!-- Lightbox con fondo borroso -->
<div
  class="lightbox"
  *ngIf="showLightbox()"
  (click)="closeLightbox()"
  (touchstart)="onTouchStart($event)"
  (touchend)="onTouchEnd($event)"
>
  <div class="lightbox__inner" (click)="$event.stopPropagation()">
    <div class="lb-blur" [style.background-image]="'url(' + currentSrc + ')'"></div>

    <img class="lb-image" [src]="currentSrc" [alt]="album?.title || 'Foto'" />

    <button class="lightbox__nav lightbox__prev" type="button" (click)="prev()" aria-label="Anterior">‹</button>
    <button class="lightbox__nav lightbox__next" type="button" (click)="next()" aria-label="Siguiente">›</button>

    <a class="lightbox__download"
       [href]="currentSrc"
       [attr.download]="currentFilename"
       title="Descargar"
       (click)="$event.stopPropagation()"
       (mousedown)="$event.preventDefault()">⤓</a>

    <button class="lightbox__close" type="button" (click)="closeLightbox()" aria-label="Cerrar">×</button>

    <div class="lightbox__counter">{{ current() + 1 }} / {{ images.length }}</div>
  </div>
</div>
